var GatedContent=function(){var e=this,t=$("#gated-content-form"),a=t.find("button"),n=($(".gated-content"),$(".errors"));return e.methods={init:function(){e.methods.bindUserEvents(),e.methods.checkSuccess()},checkSuccess:function(){"?success=1"==window.location.search&&$("html, body").animate({scrollTop:$(document).height()},1500)},bindUserEvents:function(){t.on("submit",e.methods.onFormSubmit),CountryDataConsent()},onFormSubmit:function(e){e.preventDefault();t.serialize();$.ajax("/scripts/gatedContent.php",{type:"POST",dataType:"json",data:t.serialize(),beforeSend:function(){n.removeClass("show"),a.attr("disabled","disabled")},success:function(e){if("error"==e.status&&e.errors){t.find($("input")).removeClass("error"),n.empty(),a.removeAttr("disabled");for(var o=0;o<e.errors.length;o++)"Email"==e.errors[o]?($('input[name="Email"]').addClass("error"),n.append("<li>Please enter a valid email address.</li>")):"FirstName"==e.errors[o]?($('input[name="FirstName"]').addClass("error"),n.append("<li>Please enter your first name.</li>")):"Phone"==e.errors[o]?($('input[name="Phone"]').addClass("error"),n.append("<li>Please enter your phone number.</li>")):"LastName"==e.errors[o]?($('input[name="LastName"]').addClass("error"),n.append("<li>Please enter your last name.</li>")):"Website"==e.errors[o]?($('input[name="Website"]').addClass("error"),n.append("<li>Please enter your company website.</li>")):"Company"==e.errors[o]&&($('input[name="Company"]').addClass("error"),n.append("<li>Please provide your company name.</li>"));$("html, body").animate({scrollTop:n.offset().top-140},1500)}else"sendFail"==e.status?warningMsg.text("Whoops! There was an error on our end. Please try again."):"success"==e.status&&(window.location=$('input[name="returnURL"]').val());a.removeAttr("disabled")}})}},e.methods},BlogSort=function(){var e=this,t=$(".toggle-label, .post-date-toggle"),a=$(".toggle"),n=$(".category-dropdown-trigger"),o=$(".category-list");return e.methods={init:function(){e.methods.bindUserEvents()},bindUserEvents:function(){t.on("click",function(){var e=$(this).attr("data-toggle");switch(e){case"toggle-right":a.removeClass("toggle-left"),a.addClass(e),$(this).hasClass("post-date-toggle")&&(location.href="?sort=oldest");break;case"toggle-left":a.removeClass("toggle-right"),a.addClass(e),$(this).hasClass("post-date-toggle")&&(location.href=location.origin+location.pathname)}}),n.on("click",function(e){e.preventDefault(),o.toggleClass("active")})}},e.methods},ChildrenNav=function(){function e(){0==$(".child-nav-list").length&&$(".list-cube + .list").append(window.childNavList)}window.innerWidth>1025&&$(".img-cube").addClass("show");var t=this,a=$(".children-nav"),n=$(".list-cube"),o=n.find($(".secondary-hamburger")),i=a.find($(".list"));return $img=$(".img-cube"),t.methods={init:function(){t.methods.bindUserEvents()},bindUserEvents:function(){n.on("click",function(){e(),o.toggleClass("open"),n.toggleClass("open"),i.toggleClass("open"),$img.toggleClass("open")})}},t.methods},Nav=function(){function e(){0==$(".overlay.overlay-search").length&&($(".nav-wrapper").after(window.overlaySearch),l=$(".overlay-search"),d=$(".modal-search"),u=$(".modal-close"),h=$(".overlay"),p=$(".modal"),u.on("click",function(){h.removeClass("active"),p.removeClass("active")}))}function t(e){0==$(".overlay.overlay-video").length&&($(".footer").after(window.videoOverlay),c=$(".overlay-video"),s=$(".video-frame"),m=$(".modal-video"),r=$(".video-close"),h=$(".overlay"),p=$(".modal"),r.on("click",function(){s.attr("src",""),h.removeClass("active"),p.removeClass("active")}))}var a=this,n=$(".language-trigger"),o=$(".search-trigger"),i=$(".video-trigger"),s=$(".video-frame"),r=$(".video-close"),l=$(".overlay-search"),c=$(".overlay-video"),d=$(".modal-search"),m=$(".modal-video"),u=$(".modal-close"),p=$(".modal"),h=$(".overlay"),v=$(".main-hamburger"),f=$(".main-menu");return a.methods={init:function(){a.methods.bindUserEvents()},bindUserEvents:function(){i.on("click",function(){t(this);var e=$(this).attr("data-source");s.attr("src",e),c.addClass("active"),m.addClass("active")}),o.on("click",function(){e(),l.addClass("active"),d.addClass("active"),$("#searchForm input").focus()}),r.on("click",function(){s.attr("src",""),h.removeClass("active"),p.removeClass("active")}),u.on("click",function(){h.removeClass("active"),p.removeClass("active")}),n.on("click",function(e){e.preventDefault(),$(this).next($("ul")).toggleClass("active"),$(".dropdown").removeClass("active"),v.removeClass("open"),f.removeClass("active"),$(".wrapper").removeClass("active")}),v.on("click",function(){$("body, .footer").toggleClass("no-scroll"),$(this).toggleClass("open"),f.toggleClass("active"),$(".wrapper").toggleClass("active")})}},a.methods},Dropdown=function(){function e(){0==$("#language-menu").length&&l.after(window.languageMenu)}var t=this,a=$(".dropdown"),n=$(".primary-trigger"),o=$(".tertiary"),i=$(".secondary-trigger"),s=$(".menu-back"),r=$(".secondary-back-btn"),l=$(".language-trigger"),c=($(".main-hamburger"),$(window));return t.methods={init:function(){t.methods.bindUserEvents()},bindUserEvents:function(){c.bind("resize",function(){$(".main-menu").hasClass("active")}),n.on("click",function(){n.removeClass("active"),a.removeClass("active"),$(this).addClass("active"),$(this).siblings().addClass("active"),e(),l.next($("ul")).removeClass("active")}),s.on("click",function(e){e.preventDefault(),$(".dropdown.active").removeClass("active"),$(".tertiary.active").removeClass("active")}),i.on("click",function(e){e.preventDefault(),i.removeClass("active"),o.removeClass("active"),$(this).addClass("active"),$(this).parent().siblings(".tertiary").addClass("active")}),r.on("click",function(e){e.preventDefault(),$(".tertiary.active").removeClass("active")}),$(".dropdown.active").on("mouseenter",function(){$(this).siblings().addClass("active")}),$(document).keyup(function(e){27==e.keyCode&&(n.find($("span")).removeClass("active"),n.find($(".dropdown")).removeClass("active"))})}},t.methods},CountryDataConsent=function(){$("#country-select").change(function(){1==$(this).find(":selected").data("consent")?$("#data-consent").fadeIn():($("#data-consent").fadeOut(),$("#data-consent input").prop("checked",!1))})},ContactForm=function(){var e=this,t=$("#contact-form"),a=t.find("button"),n=$('input[name="returnURL"]').val(),o=$(".errors");return e.methods={init:function(){e.methods.bindUserEvents()},bindUserEvents:function(){t.on("submit",e.methods.onFormSubmit),CountryDataConsent()},onFormSubmit:function(e){e.preventDefault();t.serialize();$.ajax("/scripts/contact.php",{type:"POST",dataType:"json",crossDomain:!0,data:t.serialize(),beforeSend:function(){o.removeClass("show"),a.attr("disabled","disabled")},success:function(e){if("error"==e.status&&e.errors){console.log(e.errors),t.find($("input")).removeClass("error"),o.empty(),a.removeAttr("disabled");for(var i=0;i<e.errors.length;i++)"Email"==e.errors[i]?($('input[name="Email"]').addClass("error"),o.append("<li>Please enter a valid email address.</li>")):"Phone"==e.errors[i]?($('input[name="Phone"]').addClass("error"),o.append("<li>Please enter your phone number.</li>")):"FirstName"==e.errors[i]?($('input[name="FirstName"]').addClass("error"),o.append("<li>Please enter your first name.</li>")):"LastName"==e.errors[i]?($('input[name="LastName"]').addClass("error"),o.append("<li>Please enter your last name.</li>")):"CommentsfromContactUsForm"==e.errors[i]?($('textarea[name="CommentsfromContactUsForm"]').addClass("error"),o.append("<li>Please add a message.</li>")):"Website"==e.errors[i]?($('input[name="Website"]').addClass("error"),o.append("<li>Please enter your company website.</li>")):"Company"==e.errors[i]&&($('input[name="Company"]').addClass("error"),o.append("<li>Please provide your company name.</li>"));$("html, body").animate({scrollTop:o.offset().top-140},1500)}else"sendFail"==e.status?warningMsg.text("Whoops! There was an error on our end. Please try again."):"success"==e.status&&("undefined"==typeof n?$(".contact-form").slideUp(function(){$(".contact-confirmation").fadeIn()}):window.location=n);a.removeAttr("disabled")}})}},e.methods},MainMenu=function(){var e=this,t=$("#hamburger"),a=$(".menu");return e.methods={init:function(){e.methods.bindUserEvents()},bindUserEvents:function(){t.on("click",function(e){e.preventDefault(),$(this).toggleClass("open"),a.toggleClass("show")})}},e.methods},FormLabels=function(){var e=this,t=$(".form-labels input"),a=$(".form-labels textarea");return e.methods={init:function(){e.methods.bindUserEvents()},bindUserEvents:function(){t.on("blur",function(){""===$(this).val()&&$(this).parent().removeClass("typing")}),a.on("blur",function(){""===$(this).val()&&$(this).parent().removeClass("typing")}),t.on("focus",function(){$(this).parent().addClass("typing")}),a.on("focus",function(){$(this).parent().addClass("typing")}),t&&t.each(function(){""===$(this).val()?$(this).parent().removeClass("typing"):$(this).parent().addClass("typing")}),a&&a.each(function(){""===$(this).val()?$(this).parent().removeClass("typing"):$(this).parent().addClass("typing")})}},e.methods},MobileSniff=function(){var e=this;return e.methods={isMobile:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|iPhone|iPad|iPod|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},iPhone:function(){var e=!1;return navigator.userAgent.match(/iPhone/i)&&(e=!0),e}},e.methods},Main=function(){var e=this;return e.methods={init:function(){e.formLabels=new FormLabels,e.formLabels.init(),e.mainMenu=new MainMenu,e.mainMenu.init(),e.dropdown=new Dropdown,e.dropdown.init(),e.nav=new Nav,e.nav.init()}},e.methods},Carousel=function(){(new MobileSniff).isMobile()};$(document).ready(function(){function e(e){var t=e.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof t[1]&&t[1].length>0&&t[1].toLowerCase()!==location.protocol||"string"==typeof t[2]&&t[2].length>0&&t[2].replace(new RegExp(":("+{"http:":80,"https:":443}[location.protocol]+")?$"),"")!==location.host}function t(){var e=window.pageYOffset;l.forEach(function(t){var a=t.offsetHeight+425,n=t.offsetTop+525;sectionId="#"+t.getAttribute("id"),e>n&&e<=n+a&&($(".navigation ul li").removeClass("active"),$(".navigation a[href='"+sectionId+"']").parent().addClass("active"))})}var a=new Main;a.init(),$(".carousel").each(function(){var e=$(this).data("autoplay").length>0?$(this).data("autoplay"):5e3;$(this).flickity({contain:!0,wrapAround:!0,pauseAutoPlayOnHover:!1,imagesLoaded:!0,autoPlay:e})}),$(".flickity-button.next").addClass("next-slide").html("▶"),$(".flickity-button.previous").addClass("prev-slide").html("◀");var n=window.location.hostname;$('a[href^="https://"], a[href^="http://"]').not('a[href*="'+n+'"]').attr("target","_blank");var o=$(".wrapper .hero + .module"),i=$(".module-page-content .container");if(console.log(i),location.pathname.includes("/contact")&&window.innerWidth>767?($(".module-page-content .container").prepend(o),$(".block-6.content").addClass("module").css("padding-left","0px").append(i)):location.pathname.includes("/contact")&&o.find("iframe").css("height","1200px"),$(window).scroll(function(){$(this).scrollTop()>100?$("#scroll").fadeIn():$("#scroll").fadeOut()}),$("#scroll").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".module-page-content").length){var s=$("body").data("site-handle");"zh"==s&&$(".module-page-content .container a").each(function(){var e=$(this).attr("href"),t=e.indexOf("/tw/")!==-1;t||$(this).attr("href",e.replace("https://www.microban.com","/tw"))})}$(".module .block-12 a.text-link.blue, .hero.medium.partners a.text-link.white").each(function(){var e=$(this).text(),t=$(this).attr("href");$(this).replaceWith('<button data-link="'+t+'" style="padding:0 60px; padding-right: 30px; line-height:17px; text-align:left;" class="btn light-blue btn-replaced" type="submit" name="Login" value="Login"><span class="shield"><img class="" style="height:auto" width="30" height="30" src="/images/shield-blue.svg"/></span>'+e+"</button>")}),$(".btn.btn-replaced").on("click",function(){var t=$(this).attr("data-link");e(t)?window.open(t,"_blank").focus():window.location.href=t});var r=(new LazyLoad({elements_selector:".bg-lazy",callback_loaded:function(e){var t=$(e);innerWidth<767&&t.data("mobile-bg").length>0&&t.css("background-image","url("+t.data("mobile-bg")+")")}}),new LazyLoad({elements_selector:".lazyload"}),new LazyLoad({elements_selector:".lazyvideo"}),$(".main-menu-parent#aegis ul.secondary .flex-item-3").length);1==r?$(".main-menu-parent#aegis ul.secondary .flex-row").css("width","300px"):2==r&&$(".main-menu-parent#aegis ul.secondary .flex-row").css("width","600px"),$(".side-bar").length&&($(".module-page-content").addClass("has-sidebar"),$(".module-page-content.has-sidebar").wrap('<div class="block-10"></div>'),setTimeout(function(){$(".module-page-content.has-sidebar").parent().next().css("height",$(".module-page-content.has-sidebar").parent().height()+"px");var e=$(".module-page-content.has-sidebar").parent();e.next().after(e)},100),$(".anchor").each(function(){var e=$(this).data("id");$(this).next().addClass("anchor-section").attr("id",e)}));var l=document.querySelectorAll(".anchor-section");window.addEventListener("scroll",t,{passive:!0}),$(".js-anchor-link").length&&innerWidth>1090&&($(window).scroll(function(){var e=$(window).scrollTop();e>$(".module").offset().top-150?$(".side-bar").addClass("sticky"):e<$(".module").offset().top-150&&$(".side-bar").removeClass("sticky"),e>$(".module-featured-content.has-sidebar").offset().top-800?$(".side-bar").addClass("bottom-static"):e<$(".module-featured-content.has-sidebar").offset().top-800&&$(".side-bar").removeClass("bottom-static")}),$(".js-anchor-link").on("click",function(e){e.preventDefault();var t=$($(this).attr("href"));if(t.length){var a=t.offset().top-140;$("body, html").animate({scrollTop:a+"px"},800)}}),"/about-microban/memberships-certifications"==location.pathname&&setTimeout(function(){localStorage.partnerTarget&&($('.js-anchor-link[href="'+localStorage.partnerTarget+'"]').click(),localStorage.removeItem(partnerTarget))},500)),innerWidth<767&&$(".hero").each(function(){var e=$(this);if(e.data("mobile-banner").length>0){var t=e.data("mobile-banner");e.attr("style","background-image:url("+t+")")}}),$(".module-brands").each(function(){$(this).next().hasClass("join-above")&&$(this).addClass("cta-sibling")})});